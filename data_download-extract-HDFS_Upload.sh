#!/bin/bash
###############################################################################################
###############################################################################################
# DOWNLOADING DATA
echo "################################################################"
echo "####################   DOWNLOADING DATA   ######################"
echo "################################################################"
wget http://diybigdata.net/downloads/data/airline-data.2013-2015.tar.gz

###############################################################################################
###############################################################################################
# EXTRACTING DATA
echo "################################################################"
echo "####################   EXTRACTING DATA    ######################"
echo "################################################################"
tar xzf airline-data.2013-2015.tar.gz

###############################################################################################
###############################################################################################
# CREATING DIRECORY IN HDFS
echo "################################################################"
echo "################   CREATING DIRECORY IN HDFS   #################"
echo "################################################################"
hadoop fs -mkdir /airline-data

###############################################################################################
###############################################################################################
# LOADING DATA IN HDFS
echo "################################################################"
echo "##################   LOADING DATA IN HDFS   ####################"
echo "################################################################"
for filename in /home/hduser/airline-data-small/*.csv;
do
        echo "uploading - ${filename}"
        hadoop fs -put "${filename}" /airline-data
done
